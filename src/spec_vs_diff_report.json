{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-10T21:16:30.565Z",
  "summary": "Frontend adds a top-level React error boundary and new Secretary hooks for geography lookups, issue lists, similar-city search, and instance availability checks via backend calls. However, the diff summary does not show backend implementations of the new Secretary-specific Motoko query endpoints, and the Secretary widgetâ€™s full routing behavior (view vs create flow) cannot be confirmed from the truncated snippet.",
  "missing_requirements": [
    {
      "id": "REQ-1",
      "requirement": "Add Secretary-specific Motoko query endpoints getStateById(hierarchicalId), getCountyById(hierarchicalId), and getCityById(hierarchicalId) as read-only queries returning null/not-found safely.",
      "reason": "Frontend hooks call actor.getStateById/getCountyById/getCityById, but the backend diff snippet does not show these functions being added in backend/main.mo, so their implementation cannot be verified from the provided diff summary.",
      "evidence": [
        "backend/main.mo (truncated; no visible getStateById/getCountyById/getCityById definitions)",
        "frontend/src/hooks/useSecretaryGeography.ts (calls actor.getStateById / actor.getCountyById / actor.getCityById)"
      ]
    },
    {
      "id": "REQ-2",
      "requirement": "Add a Secretary-specific Motoko query endpoint getTop50IssuesForLocation(level, hierarchicalId?) backed by existing stable category lists; safe defaults for unsupported inputs.",
      "reason": "Frontend hook calls actor.getTop50IssuesForLocation, but the backend diff snippet does not show this query endpoint being added/implemented in backend/main.mo.",
      "evidence": [
        "backend/main.mo (truncated; no visible getTop50IssuesForLocation definition)",
        "frontend/src/hooks/useSecretaryGeography.ts (calls actor.getTop50IssuesForLocation)"
      ]
    },
    {
      "id": "REQ-3",
      "requirement": "Add Motoko query endpoint searchSimilarCityNames(searchString) returning bounded, case-insensitive USPlace matches; empty/short input returns empty list safely.",
      "reason": "A frontend hook for similar-city search is added but the code is truncated and the backend implementation is not visible in backend/main.mo, so the required backend endpoint behavior cannot be confirmed.",
      "evidence": [
        "backend/main.mo (truncated; no visible searchSimilarCityNames definition)",
        "frontend/src/hooks/useSecretaryGeography.ts (adds useSearchSimilarCityNames; implementation truncated)"
      ]
    },
    {
      "id": "REQ-4",
      "requirement": "Update Secretary frontend logic to determine instance availability via backend call (no client-side scanning of all proposals) and route user to view-existing vs create-instance flow based on canonical instance name.",
      "reason": "The diff clearly adds a backend-driven availability hook using actor.isInstanceNameTaken, but the SecretaryWidget.tsx changes are truncated and do not show the full decision + routing to 'view instance' vs 'create proposal/instance' flow; therefore full compliance cannot be verified from provided evidence.",
      "evidence": [
        "frontend/src/hooks/useSecretaryInstanceAvailability.ts (calls actor.isInstanceNameTaken with generated canonical name)",
        "frontend/src/components/secretary/SecretaryWidget.tsx (truncated around useSecretaryInstanceAvailability usage; routing/actions not visible)"
      ]
    }
  ],
  "hallucinated_features": [],
  "confidence": 0.62,
  "changed_files": [
    "backend/main.mo",
    "frontend-file-summaries.txt",
    "frontend/src/App.tsx",
    "frontend/src/components/common/AppErrorBoundary.tsx",
    "frontend/src/components/secretary/SecretaryWidget.tsx",
    "frontend/src/hooks/useSecretaryGeography.ts",
    "frontend/src/hooks/useSecretaryInstanceAvailability.ts",
    "frontend/src/lib/uiCopy.ts",
    "frontend/src/lib/whisperInstanceNaming.ts",
    "project_state.json"
  ]
}